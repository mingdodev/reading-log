예를 들어, 모듈로 연산으로 캐시 키를 어떤 서버에 배치할지 결정하는 방식에서는, 캐시 서버들 중 하나가 죽었을 때 거의 대부분의 캐시 키를 재분배 해야 한다는 문제가 있다. 이는 대규모 캐시 미스를 일으킨다.

**안정 해시**는 해시 값으로 서버에 데이터를 분배할 때, 분산 서버의 상태가 변화(추가/삭제)하는 상황에서도 안정적으로 데이터를 재분배할 수 있도록 만드는 기술이다. 

## 안정 해시

- 캐시 키 재배치가 k/n개에 대해서만 일어남

- **해시 링**을 이용한 기본 구현법은 파티션의 크기가 균등하지 않고, 키의 균등 분포가 어렵다는 문제점이 있었음

- **가상 노드**를 이용하면 해시 링 공간을 균등한 크기로 작게 쪼갠 공간들을 노드들이 관리하게 되고, 키의 분포가 균등해짐

    - `s1_0, s0_0, s1_1, s0_1, s1_2, s0_2` 이런 식으로 서버 당 가상 노드 데이터를 차례대로 배치

> 노드 수를 늘리면 책임져야 할 해시 공간이 줄어듣니 키가 균등하게 서버에 저장된다. 다만 가상 노드 데이터를 저장할 공간은 더 늘어나니 tradeoff를 고려하여 설계해야 한다.